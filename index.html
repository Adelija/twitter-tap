<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Twitter Tap : A python tool for collecting tweets in mongoDB using the search API" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Twitter Tap</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/janezkranjc/twitter-tap">View on GitHub</a>

          <h1 id="project_title">Twitter Tap</h1>
          <h2 id="project_tagline">A python tool for collecting tweets in mongoDB using the search API</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/janezkranjc/twitter-tap/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/janezkranjc/twitter-tap/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="twitter-tap" class="anchor" href="#twitter-tap"><span class="octicon octicon-link"></span></a>Twitter Tap</h1>

<p>Collect tweets to a mongoDB using the twitter search API.</p>

<h1>
<a name="about" class="anchor" href="#about"><span class="octicon octicon-link"></span></a>About</h1>

<p>Twitter Tap is a python tool that connects to the Twitter API and issues
calls to the search endpoint using a query that the user has entered.
The tool follows all the <strong>next_results</strong> links (with the corresponding
<strong>max_id</strong>) so that all results are collected. When all the
<strong>next_results</strong> links are exhausted the query is repeated using the
<strong>since_id</strong> of the latest tweet from the results of the first query
and follows all the <strong>next_results</strong> links again. The latest
<strong>since_id</strong> is also stored in the database for each distinct query
(query, geolocation, language), so that when the tool is restarted you
will still only receive unique tweets.</p>

<p>Tweets are stored into a mongoDB, which has a unique index on the Tweet
ID so that there is no duplication of data if more than 1 query is
executed simultaneously.</p>

<p>There is an arbitrary wait time before each API call so that the rate
limit is not reached. The default value of 2 seconds makes sure that
there are no more than 450 requests per 15 minutes as is the rate limit
of the search endpoint for authenticating with the app (not the user).</p>

<p>The tool can be run from the command line or be run as a daemon using
supervisor (recommended). A sample supervisord.conf script is included
with the tool.</p>

<h1>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Install Twitter Tap using <code>pip &lt;http://www.pip-installer.org/&gt;</code>__</p>

<p>.. code:: bash</p>

<pre><code>pip install twitter-tap
</code></pre>

<p>Or, if you want the current code</p>

<p>.. code:: bash</p>

<pre><code>git clone git://github.com/janezkranjc/twitter-tap.git
cd twitter-tap
python setup.py install
</code></pre>

<h1>
<a name="before-you-start" class="anchor" href="#before-you-start"><span class="octicon octicon-link"></span></a>Before you start</h1>

<p>Please follow this link <a href="https://apps.twitter.com/">https://apps.twitter.com/</a> and create a twitter
app. You will need the consumer key and consumer secret to access the
twitter API.</p>

<h1>
<a name="using-twitter-tap" class="anchor" href="#using-twitter-tap"><span class="octicon octicon-link"></span></a>Using twitter tap</h1>

<p>Run Twitter Tap in the command line like this.</p>

<p>.. code:: bash</p>

<pre><code>tap
</code></pre>

<p>Show help text</p>

<pre><code>
.. code:: bash

    tap -h

Executing a query
</code></pre>

<p>To execute a query you must provide a <strong>query</strong>, the <strong>consumer secret</strong>
and either the <strong>consumer key</strong> or the access token. Consumer key and
secret can be obtained at the <a href="http://apps.twitter.com/">http://apps.twitter.com/</a> website, while
the access token will be obtained when first connecting with the key and
secret.</p>

<p>.. code:: bash</p>

<pre><code>tap --consumer-key CONSUMERKEY --consumer-secret CONSUMERSECRET -q "miley cyrus" -v DEBUG
</code></pre>

<h1>
<a name="running-as-a-daemon" class="anchor" href="#running-as-a-daemon"><span class="octicon octicon-link"></span></a>Running as a daemon</h1>

<p>To run Tap as a daemon you are encouraged to use supervisor. (Doesn't
work natively under windows. You should use cygwin.)</p>

<p>Here is a sample supervisord.conf file for running tap</p>

<p>.. code:: bash</p>

<pre><code>; Sample supervisor config file for daemonizing the twitter search to mongodb software

[inet_http_server]          ; inet (TCP) server disabled by default
port=127.0.0.1:9001         ; (ip_address:port specifier, *:port for all iface)
username=manorastroman      ; (default is no username (open server))
password=kingofthedragonmen ; (default is no password (open server))

[supervisord]
stopsignal=INT
logfile=supervisord.log      ; (main log file;default $CWD/supervisord.log)
logfile_maxbytes=50MB        ; (max main logfile bytes b4 rotation;default 50MB)
logfile_backups=10           ; (num of main logfile rotation backups;default 10)
loglevel=info                ; (log level;default info; others: debug,warn,trace)
pidfile=supervisord.pid      ; (supervisord pidfile;default supervisord.pid)
nodaemon=false               ; (start in foreground if true;default false)
minfds=1024                  ; (min. avail startup file descriptors;default 1024)
minprocs=200                 ; (min. avail process descriptors;default 200)

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket
username=manorastroman       ; should be same as http_username if set
password=kingofthedragonmen  ; should be same as http_password if set

[program:tap]
command=tap --consumer-key CONSUMERKEY --consumer-secret CONSUMERSECRET -q "janez kranjc" -v DEBUG
stdout_logfile=tap.log
stderr_logfile=tap_err.log
autostart=true
autorestart=true
startsecs=10
stopwaitsecs=10
</code></pre>

<p>Afterwards you can start the daemon like this (you must be in the same
folder as supervisord.conf or your supervisord.conf must be /etc/)</p>

<p>.. code:: bash</p>

<pre><code>supervisord
</code></pre>

<p>Open your browser to <a href="http://127.0.0.1:9001">http://127.0.0.1:9001</a> to see the status of the
daemon. By default the username is manorastroman and the password
kingofthedragonmen.</p>

<p>Alternatively you can see the status like this</p>

<p>.. code:: bash</p>

<pre><code>supervisorctl status
</code></pre>

<p>Or see the tail of the logs (log file locations can be setup in
supervisord.conf)</p>

<p>.. code:: bash</p>

<pre><code>supervisorctl tail tap
</code></pre>

<p>Whenever you feel like shutting it down</p>

<p>.. code:: bash</p>

<pre><code>supervisorctl shutdown
</code></pre>

<h1>
<a name="useful-links" class="anchor" href="#useful-links"><span class="octicon octicon-link"></span></a>Useful Links</h1>

<ul>
<li> <strong>MongoDB</strong> <a href="https://www.mongodb.org/">https://www.mongodb.org/</a>
</li>
<li> <strong>Twitter developers</strong> <a href="https://dev.twitter.com/">https://dev.twitter.com/</a>
</li>
<li> <strong>Supervisor</strong> <a href="http://supervisord.org/">http://supervisord.org/</a>
</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Twitter Tap maintained by <a href="https://github.com/janezkranjc">janezkranjc</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-2921908-14");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
